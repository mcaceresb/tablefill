Getting Started
===============

You can use tablefill from the command line or from python. To install,
run

```bash
pip install git+https://github.com/mcaceresb/tablefill
```

Then you can call tablefill via
```bash
tablefill -i input1.tex [input2.tex ...] -o output.tex template.tex
```

The section below shows a basic example of how `tablefill` works. See
the [sample workflow](sample-workflow.md) section for details on how to
go from results in Stata/R/etc. to automated table production in LaTeX.

Basic Example
-------------

`input1.txt` contains the data used to fill the template. This file is
generated your programming language of choice (e.g. Stata) with output
from a regression, a table with summary statistics, etc. The entries
must be tab-delimited and each section separated by a label of the format
`<tab:label>` (see the [sample programs](sample-programs.md) for examples on
how to do this on various programming languages):

```
<tab:example>
    1 	  1237.1234 	 1 	  	 2
    2 	  2234.4    	 3 	  	 2.4
    3 	  3.345345  	 2 	  	 2.456
    4 	  2234.4    	 3 	  	 2.4
<tab:anotherExample>
     -1.25	       -1.18	 0.1447266
     2.756	       -0.53	 9.964426e-08
      1.13	     0.57235	 0.02417291
```

`template.tex` contains the LaTeX file with placeholders corresponding
to the data in `input1.txt`. The template should compile as is:

```latex
\documentclass{article}
\usepackage{booktabs}
\begin{document}
\begin{table}
  \caption{Table caption (e.g. summary stats)}
  \label{tab:example} % name must match label in input1.txt
  \begin{tabular}{p{4.25cm}crcc}
    Outcomes
    & N
    & Mean
    & (Std.)
    \\
    Outcomes \#\#\# & \#1,\# & \#1\# & (\#1\#) \\
    Outcomes \#\#\# & \#0,\# & \#1\# & (\#1\#) \\
    Outcomes \#\#\# & \#1,\# & \#1\# & (\#1\#) \\
    Outcomes \#\#\# & \#0,\# & \#1\# & (\#1\#) \\
    \multicolumn{4}{p{5cm}}{\footnotesize Footnotes!}
  \end{tabular}
\end{table}

\begin{table}
  \caption{Table caption (e.g. regression results)}
  \label{tab:anotherExample} % name must match label in input1.txt
  \begin{tabular}{p{4.25cm}cc}
    Variables
    & Coef
    & (SE)
    \\
    Variable 1 & \#2\# (\#2\#)\#*\# \\
    Variable 2 & \#2\# (\#2\#)\#*\# \\
    Variable 3 & \#2\# (\#2\#)\#*\# \\
    \multicolumn{4}{p{5cm}}{\footnotesize Footnotes!}
  \end{tabular}
\end{table}
\end{document}
```

Note that each table environment is labeled, and the label corresponds
to the set of results we want to fill that table with. Further note
that the shape of the input matrices correspond to the _**number**_ of
placeholders in the table environment (the shape need not be the same;
see the [matrix input](usage/02matrix-input.md) section for details).
To fill the template, run

```bash
tablefill -i input1.txt -o filled.tex template.tex
```

This produces the file `filled.tex`:

```latex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This file was produced by 'tablefill.py'
% 	Template file: /home/mauricio/Documents/projects/dev/code/archive/2015/tablefill/docs/usage/01basic/template.tex
% 	Input file(s): ['/home/mauricio/Documents/projects/dev/code/archive/2015/tablefill/docs/usage/01basic/input1.txt']
% To make changes, edit the input and template files.
% %

% DO NOT EDIT THIS FILE DIRECTLY.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{article}
\usepackage{booktabs}
\begin{document}
\begin{table}
  \caption{Table caption (e.g. summary stats)}
  \label{tab:example} % name must match label in input1.txt
  \begin{tabular}{p{4.25cm}crcc}
    Outcomes
    & N
    & Mean
    & (Std.)
    \
    Outcomes 1 & 1,237.1 & 1.0 & (2.0) \
    Outcomes 2 & 2,234 & 3.0 & (2.4) \
    Outcomes 3 & 3.3 & 2.0 & (2.5) \
    Outcomes 4 & 2,234 & 3.0 & (2.4) \
    \multicolumn{4}{p{5cm}}{\footnotesize Footnotes!}
  \end{tabular}
\end{table}

\begin{table}
  \caption{Table caption (e.g. regression results)}
  \label{tab:anotherExample} % name must match label in input1.txt
  \begin{tabular}{p{4.25cm}c}
    Variables
    & Coef
    & (SE)
    \
    Variable 1 & -1.25 (-1.18) \
    Variable 2 & 2.76 (-0.53)*** \
    Variable 3 & 1.13 (0.57)** \
    \multicolumn{4}{p{5cm}}{\footnotesize Footnotes!}
  \end{tabular}
\end{table}
\end{document}
```

The placeholders in `tab:example` were replaced with the entries right
under `<tab:example>` in the file `input1.txt`, and similarly with
`tab:anotherExample`. `tablefill` assumes that the input ends when the
next placeholder starts or at the end of the file.

Note that the entries have been formatted based on the directions passed
by the placeholders.

Explanation
-----------

The way `tablefill` operates is:

1. Per line, the program searches for a `\begin{table}` statement..
2. If found, it searches for a `\label{tab:(.+)}` BEFORE an `\end{table}`.
3. If a label is found, it searches the input files for a label a match.
4. Find all occurrences of placeholders (note that in LaTeX, `#` is a
   special character, so `tablefill` will match both `#` and `\#` as part
   of a placeholder construct; this is so that templates can be compiled
   before using `tablefill` to fill in the values):

Placeholder  | Format
------------ | ------
`###`        | Replace as is; input can be text (all other placeholders require numbers).
`#\d+#`      | Round to `\d+` digits.
`#\d+,#`     | Round to `\d+` digits; add thousands comma separator.
`#*#`        | Interpret input as p-value and replce with a star corresponding so significance. Detault is `* 0.1, **0.05, ***0.01`.
`#\d+%#`     | Round to `\d+` digits; interpret as percentage.
`|###|`      | Get the absolute value of the number.

5. Repeat 3 and 4 until reaching `\end{table}`
6. Move on to next table: Repeat 1 to 5 until reaching the end of the document.

We can see this in the example above:

1. `\#\#\#` was replaced as is.
2. `\#0\#`, `\#1\#`, and `\#2\#` were rounded to 0, 1, and 2 significant digits.
3. `\#0,\#` were comma-delimited.
4. `\#*\#` were replaced with significance stars.
